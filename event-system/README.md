# Event Processing System

–°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π —Å –æ—á–µ—Ä–µ–¥—è–º–∏, retry –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º.

## üöÄ Features

- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ (queued, processing, processed, failed)
- ‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –ø–æ–ø—ã—Ç–æ–∫
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π (jsonb)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –ë–î

## üõ†Ô∏è Tech Stack

- **Go 1.21+** - —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **GORM** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **PostgreSQL** - —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (jsonb –ø–æ–¥–¥–µ—Ä–∂–∫–∞)
- **Fiber** - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ (Fast HTTP)
- **Docker Compose** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

## üöÄ Quick Start

–û–¥–∏–Ω –∫–æ–º–∞–Ω–¥–æ–π –∑–∞–ø—É—Å–∫–∞–µ–º –≤—Å—ë:

```bash
docker compose up --build
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–∂–¥–µ—Ç—Å—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|--------------|----------|
| `DB_DSN` | - | –ü–æ–ª–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Postgres |
| `DB_HOST` | `db` | –•–æ—Å—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `DB_PORT` | `5432` | –ü–æ—Ä—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `DB_USER` | `postgres` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î |
| `DB_PASS` | `postgres` | –ü–∞—Ä–æ–ª—å –ë–î |
| `DB_NAME` | `event_system` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö |
| `PORT` | `8080` | –ü–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
| `MAX_RETRIES` | `3` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `PROCESS_TIMEOUT` | `30s` | –¢–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è |

## üìñ API Endpoints

### POST /events - –°–æ–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ —Å–∏—Å—Ç–µ–º–µ.

**Request Body:**
```json
{
  "type": "user_registered",
  "payload": {
    "user_id": "123",
    "email": "user@example.com",
    "timestamp": "2026-02-19T10:00:00Z"
  }
}
```

**Response:**
- `201 Created` - –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ
```json
{
  "id": "550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d",
  "type": "user_registered",
  "status": "queued",
  "created_at": "2026-02-19T10:00:00Z",
  "received_at": "2026-02-19T10:00:01Z",
  "attempts": 0
}
```

- `400 Bad Request` - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `500 Internal Server Error` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### GET /events/:id - –ü–æ–ª—É—á–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Å–æ–±—ã—Ç–∏–∏.

**Response:**
- `200 OK` - –°–æ–±—ã—Ç–∏–µ –Ω–∞–π–¥–µ–Ω–æ
```json
{
  "id": "550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d",
  "type": "user_registered",
  "status": "processed",
  "payload": {
    "user_id": "123",
    "email": "user@example.com",
    "timestamp": "2026-02-19T10:00:00Z"
  },
  "created_at": "2026-02-19T10:00:00Z",
  "received_at": "2026-02-19T10:00:01Z",
  "processed_at": "2026-02-19T10:00:30Z",
  "attempts": 1
}
```

- `404 Not Found` - –°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

### GET /events - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**Query Parameters:**
- `type` - –§–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è
- `status` - –§–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `page` - –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (default: 1)
- `limit` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (default: 20)

**Response:**
- `200 OK` - –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
```json
{
  "data": [...],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "pages": 5
  }
}
```

### POST /events/:id/process - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ

–ó–∞–ø—É—Å–∫–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è.

**Response:**
- `202 Accepted` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—É—â–µ–Ω–∞
- `400 Bad Request` - –°–æ–±—ã—Ç–∏–µ —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- `404 Not Found` - –°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

## üìä Data Models

### –¢–∞–±–ª–∏—Ü–∞ `events`

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | uuid | PK - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–±—ã—Ç–∏—è |
| `type` | string (index) | –¢–∏–ø —Å–æ–±—ã—Ç–∏—è (–Ω–µ –±–æ–ª–µ–µ 50 —Å–∏–º–≤–æ–ª–æ–≤) |
| `status` | string (index) | –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (queued, processing, processed, failed) |
| `payload` | jsonb | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è |
| `created_at` | timestamp | –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è |
| `received_at` | timestamp | –ú–æ–º–µ–Ω—Ç –ø—Ä–∏—ë–º–∞ –∑–∞–ø—Ä–æ—Å–∞ |
| `processed_at` | timestamp (null) | –ú–æ–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `error` | text (null) | –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ (–ø—Ä–∏ failed) |
| `attempts` | int (default 0) | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ |

## üõ°Ô∏è Retry Mechanism

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –º–µ—Ö–∞–Ω–∏–∑–º:

- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏:** `MAX_RETRIES` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 3)
- **–¢–∞–π–º–∞—É—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:** `PROCESS_TIMEOUT` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 30 —Å–µ–∫—É–Ω–¥)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry:** –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ `failed`
- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff:** –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
1. –°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `queued`
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –º–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `processing`
3. –ï—Å–ª–∏ —É—Å–ø–µ—Ö ‚Üí `processed`
4. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí `failed` —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏
5. –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ –∏—Å—á–µ—Ä–ø–∞–Ω—ã ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry

## üîß Background Processing

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫:

- **Event Queue:** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- **Dead Letter Queue:** —Å–æ–±—ã—Ç–∏—è —Å –∏—Å—á–µ—Ä–ø–∞–Ω–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
- **Monitoring:** –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **Cleanup:** —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π

## üö® Error Handling

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```json
{
  "error": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

| –ö–æ–¥ | –û—à–∏–±–∫–∞ |
|-----|--------|
| 400 | –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON, –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–µ, –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–∏–ø |
| 404 | –°–æ–±—ã—Ç–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ |
| 409 | –ö–æ–Ω—Ñ–ª–∏–∫—Ç (—Å–æ–±—ã—Ç–∏–µ —É–∂–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è) |
| 500 | –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ |

## üí° Examples

### –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```bash
curl -X POST http://localhost:8080/events \
  -H "Content-Type: application/json" \
  -d '{
    "type": "user_registered",
    "payload": {
      "user_id": "123",
      "email": "user@example.com",
      "timestamp": "2026-02-19T10:00:00Z"
    }
  }'
```

**Response:**
```json
{
  "id": "550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d",
  "type": "user_registered",
  "status": "queued",
  "created_at": "2026-02-19T10:00:00Z",
  "received_at": "2026-02-19T10:00:01Z",
  "attempts": 0
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è
```bash
curl http://localhost:8080/events/550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d
```

**Response:**
```json
{
  "id": "550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d",
  "type": "user_registered",
  "status": "processed",
  "payload": {
    "user_id": "123",
    "email": "user@example.com",
    "timestamp": "2026-02-19T10:00:00Z"
  },
  "created_at": "2026-02-19T10:00:00Z",
  "received_at": "2026-02-19T10:00:01Z",
  "processed_at": "2026-02-19T10:00:30Z",
  "attempts": 1
}
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è
```bash
curl -X POST http://localhost:8080/events/550e8317-ea00-4b1c-9b2a-1d3d8d1e9f1d/process
```

## üèóÔ∏è Project Structure

```
event-system/
‚îú‚îÄ‚îÄ main.go           # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ go.mod           # Go –º–æ–¥—É–ª—å
‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ event.go     # –ú–æ–¥–µ–ª—å Event
‚îú‚îÄ‚îÄ handlers/        # HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ services/        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ workers/         # –§–æ–Ω–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îú‚îÄ‚îÄ migrations/      # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ docker-compose.yml # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ Dockerfile        # Docker –æ–±—Ä–∞–∑
```

## üöÄ Development

### –ó–∞–ø—É—Å–∫ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd event-system

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
docker compose up db

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
go run main.go
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
go test ./...
```

### –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
```bash
docker build -t event-system .
```

## üìÑ License

MIT License - —Å–º. —Ñ–∞–π–ª LICENSE –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## ü§ù Contributing

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É (`git checkout -b feature/amazing-feature`)
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add amazing feature'`)
4. Push –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. Create Pull Request

---

**Made with ‚ù§Ô∏è by Event Processing Team**